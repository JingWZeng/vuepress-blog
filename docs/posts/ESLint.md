---
title: ESLintè¶…çº§è¯¦ç»†
date: 2021-10-10
sidebar: "auto"
categories:
  - ESLint
tags:
  - ESLint
---

> æ­¤æ–‡ç« è½¬è½½äº[ä» ESLint å¼€å§‹ï¼Œè¯´é€æˆ‘å¦‚ä½•åœ¨å›¢é˜Ÿé¡¹ç›®ä¸­åŸºäº Vue åšä»£ç æ ¡éªŒ](https://developer.51cto.com/art/202106/667105.htm###)
>
> è§£ç­”äº†å…³äºESLintçš„å¾ˆå¤šç–‘æƒ‘ï¼Œæ–‡ç« ç®€æ˜é€šä¿—æ˜“æ‡‚~~~

<!--more-->

æœ€è¿‘é‡åˆ°äº†ä¸€ä¸ªè€é¡¹ç›®ï¼Œæ¯”è¾ƒæœ‰æ„æ€çš„æ˜¯è¿™ä¸ªé¡¹ç›®é›†å‰åç«¯çš„ä»£ç äºä¸€èµ·ï¼Œè€Œåç«¯ä¹Ÿä¼šå»ä¿®æ”¹å‰ç«¯ä»£ç ï¼Œæ‰€ä»¥å°±å‡ºç°äº†åç«¯ç”¨ IntelliJ IDEA æ¥å¼€å‘å‰ç«¯é¡¹ç›®ï¼Œè€Œå‰ç«¯ç”¨ VSCode æ¥å¼€å‘å‰ç«¯é¡¹ç›®çš„æƒ…å†µã€‚äºæ˜¯ä¹ï¼Œå‡ºç°äº†ä»£ç è§„èŒƒçš„é—®é¢˜ï¼Œæ‰€ä»¥å°±æœ‰äº†è¿™ç¯‡æ–‡ç« ï¼Œæ•´ç†äº†ä¸€ä¸‹å‰ç«¯ä»£ç æ ¡éªŒä»¥åŠåœ¨ Vue é¡¹ç›®ä¸­çš„å®è·µã€‚

é˜…è¯»å®Œè¿™ç¯‡æ–‡ç« ï¼Œä½ å¯ä»¥æ”¶è·ï¼š

- èƒ½å¤Ÿè‡ªå·±äº²æ‰‹å†™å‡ºä¸€å¥— ESLint é…ç½®;
- ä¼šçŸ¥é“ä¸šç•Œéƒ½æœ‰å“ªäº›è‘—åçš„ JS ä»£ç è§„èŒƒï¼Œç†Ÿè¯»å®ƒä»¬å¯ä»¥è®©ä½ å†™å‡ºæ›´è§„èŒƒçš„ä»£ç ;
- vue-cli åœ¨åˆå§‹åŒ–ä¸€ä¸ªåŒ…å«ä»£ç æ ¡éªŒçš„é¡¹ç›®æ—¶éƒ½åšäº†ä»€ä¹ˆ;
- Prettier æ˜¯ä»€ä¹ˆ?ä¸ºä»€ä¹ˆè¦ä½¿ç”¨å®ƒ?å¦‚ä½•ä¸ ESLint é…åˆä½¿ç”¨?
- EditorConfig åˆæ˜¯ä»€ä¹ˆ?å¦‚ä½•ä½¿ç”¨?
- å¦‚ä½•åœ¨ VSCode ä¸­é€šè¿‡æ’ä»¶æ¥ååŠ©ä»£ç æ ¡éªŒå·¥ä½œ;
- å¦‚ä½•ä¿è¯ push åˆ°è¿œç¨‹ä»“åº“çš„ä»£ç æ˜¯ç¬¦åˆè§„èŒƒçš„;

ä¸‹é¢å¼€å§‹é˜…è¯»å§ï¼Œå¦‚æœä½ å¯¹ ESLint æ¯”è¾ƒç†Ÿæ‚‰ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡è¿™ä¸ªéƒ¨åˆ†ã€‚

### ESLint æ˜¯ä»€ä¹ˆ

ESLint æ˜¯ä¸€ä¸ªé›†ä»£ç å®¡æŸ¥å’Œä¿®å¤çš„å·¥å…·ï¼Œå®ƒçš„æ ¸å¿ƒåŠŸèƒ½æ˜¯é€šè¿‡é…ç½®ä¸€ä¸ªä¸ªè§„åˆ™æ¥é™åˆ¶ä»£ç çš„åˆæ³•æ€§å’Œé£æ ¼ã€‚



## é…ç½®è§£æå™¨å’Œè§£æå‚æ•°

ESLint çš„è§£æå™¨ï¼Œæ—©æœŸçš„æ—¶å€™ç”¨çš„æ˜¯ Esprima[1]ï¼Œåé¢åŸºäº Esprima v1.2.2 ç‰ˆæœ¬å¼€å‘äº†ä¸€ä¸ªæ–°çš„è§£æå™¨ Espree[2]ï¼Œå¹¶ä¸”æŠŠå®ƒå½“åšé»˜è®¤è§£æå™¨ã€‚

é™¤äº†ä½¿ç”¨ ESLint è‡ªå¸¦çš„è§£æå™¨å¤–ï¼Œè¿˜å¯ä»¥æŒ‡å®šå…¶ä»–è§£æå™¨ï¼š

- @babel/eslint-parser[3]ï¼šä½¿ Babel å’Œ ESLint å…¼å®¹ï¼Œå¯¹ä¸€äº› Babel è¯­æ³•æä¾›æ”¯æŒ;
- @typescript-eslint/parser[4]ï¼šTSLint è¢«å¼ƒç”¨åï¼ŒTypeScript æä¾›äº†æ­¤è§£æå™¨ç”¨äºå°†å…¶ä¸ ESTree å…¼å®¹ï¼Œä½¿ ESLint å¯¹ TypeScript è¿›è¡Œæ”¯æŒ;

ä¸ºé¡¹ç›®æŒ‡å®šæŸä¸ªé€‰æ‹©å™¨çš„åŸåˆ™æ˜¯ä»€ä¹ˆ?

- å¦‚æœä½ çš„é¡¹ç›®ç”¨åˆ°äº†æ¯”è¾ƒæ–°çš„ ES è¯­æ³•ï¼Œæ¯”å¦‚ ES2021 çš„ Promise.any()ï¼Œé‚£å°±å¯ä»¥æŒ‡å®š @babel/eslint-parser ä¸ºè§£æå™¨;
- å¦‚æœé¡¹ç›®æ˜¯åŸºäº TS å¼€å‘çš„ï¼Œé‚£å°±ä½¿ç”¨ @typescript-eslint/parser;

â€œå¦‚æœä½ å¯¹ ES æœ€æ–°æ ‡å‡†è¿˜ä¸ç†Ÿæ‚‰ï¼Œå¯ä»¥çœ‹çœ‹è¿™ç¯‡æ–‡ç« ï¼šé€ä½ ä¸€ä»½ç²¾å¿ƒæ€»ç»“çš„3ä¸‡å­—ES6å®ç”¨æŒ‡å—(ä¸‹)

é™¤äº†æŒ‡å®šè§£æå™¨ parser å¤–ï¼Œè¿˜å¯ä»¥é¢å¤–é…ç½®è§£æå™¨å‚æ•° parserOptionï¼š

```
{ 
    // ESLint é»˜è®¤è§£æå™¨ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæˆåˆ«çš„ 
    parser: "espree",  
    parserOption: { 
        // æŒ‡å®šè¦ä½¿ç”¨çš„ ECMAScript ç‰ˆæœ¬ï¼Œé»˜è®¤å€¼ 5 
        ecmaVersion: 5, 
        // è®¾ç½®ä¸º script (é»˜è®¤) æˆ– moduleï¼ˆå¦‚æœä½ çš„ä»£ç æ˜¯ ECMAScript æ¨¡å—) 
        sourceType: "script", 
        // è¿™æ˜¯ä¸ªå¯¹è±¡ï¼Œè¡¨ç¤ºä½ æƒ³ä½¿ç”¨çš„é¢å¤–çš„è¯­è¨€ç‰¹æ€§,æ‰€æœ‰é€‰é¡¹é»˜è®¤éƒ½æ˜¯ false 
        ecmafeatures: { 
            // æ˜¯å¦å…è®¸åœ¨å…¨å±€ä½œç”¨åŸŸä¸‹ä½¿ç”¨ return è¯­å¥ 
            globalReturn: false, 
            // æ˜¯å¦å¯ç”¨å…¨å±€ strict æ¨¡å¼ï¼ˆä¸¥æ ¼æ¨¡å¼ï¼‰ 
            impliedStrict: false, 
            // æ˜¯å¦å¯ç”¨JSX 
            jsx: false, 
            // æ˜¯å¦å¯ç”¨å¯¹å®éªŒæ€§çš„objectRest/spreadPropertiesçš„æ”¯æŒ 
            experimentalObjectRestSpread: false 
        } 
    } 
} 
```



## æŒ‡å®šç¯å¢ƒ env

æŒ‡å®šä¸åŒçš„ç¯å¢ƒå¯ä»¥ç»™å¯¹åº”ç¯å¢ƒä¸‹æä¾›é¢„è®¾çš„å…¨å±€å˜é‡ã€‚æ¯”å¦‚è¯´åœ¨ browser ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ window å…¨å±€å˜é‡;åœ¨ node ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨ process å…¨å±€å˜é‡ç­‰;

- ESLint ä¸­å¯é…ç½®çš„ç¯å¢ƒæ¯”è¾ƒå¤šï¼Œè¿™é‡Œæœ‰ä»½å®Œæ•´çš„ç¯å¢ƒåˆ—è¡¨[5]ï¼Œä¸‹é¢åˆ—å‡ºå‡ ä¸ªæ¯”è¾ƒå¸¸è§çš„ï¼š
- browserï¼šæµè§ˆå™¨å…¨å±€å˜é‡;
- nodeï¼šNode.js å…¨å±€å˜é‡å’Œä½œç”¨åŸŸ;
- es6ï¼šes6 ä¸­é™¤äº†æ¨¡å—ä¹‹å¤–çš„å…¶ä»–ç‰¹æ€§ï¼ŒåŒæ—¶å°†è‡ªåŠ¨è®¾ç½® parserOptions.ecmaVersion å‚æ•°ä¸º 6;ä»¥æ­¤ç±»æ¨ ES2017 æ˜¯ 7ï¼Œè€Œ ES2021 æ˜¯ 12;
- es2017ï¼šparserOptions.ecmaVersion ä¸º 8;
- es2020ï¼šparserOptions.ecmaVersion ä¸º 11;
- es2021ï¼šparserOptions.ecmaVersion ä¸º 12;

é…ç½®æ–¹å¼å¦‚ä¸‹ï¼š

```js
{ 
    env: { 
        browser: true, 
        node: true, 
        es6: true, 
        commonjs: true, 
        mocha: true, 
        jquery: true, 
    } 
} 
```

å¯ä»¥æŒ‡å®šå¤šä¸ªç¯å¢ƒå¹¶ä¸æ„å‘³ç€é…ç½®çš„ç¯å¢ƒè¶Šå¤šè¶Šå¥½ï¼Œå®é™…é…ç½®çš„æ—¶å€™è¿˜æ˜¯å¾—ä¾æ®å½“å‰é¡¹ç›®çš„ç¯å¢ƒæ¥é€‰æ‹©ã€‚



## é…ç½®å…¨å±€å˜é‡ globals

ESLint çš„ä¸€äº›æ ¸å¿ƒè§„åˆ™ä¾èµ–äºå¯¹ä»£ç åœ¨è¿è¡Œæ—¶å¯ç”¨çš„å…¨å±€å˜é‡çš„äº†è§£ã€‚ç”±äºè¿™äº›åœ¨ä¸åŒç¯å¢ƒä¹‹é—´å¯èƒ½ä¼šæœ‰å¾ˆå¤§å·®å¼‚ï¼Œå¹¶ä¸”åœ¨è¿è¡Œæ—¶ä¼šè¿›è¡Œä¿®æ”¹ï¼Œå› æ­¤ ESLint ä¸ä¼šå‡è®¾ä½ çš„æ‰§è¡Œç¯å¢ƒä¸­å­˜åœ¨å“ªäº›å…¨å±€å˜é‡ã€‚

å¦‚æœä½ æƒ³ä½¿ç”¨è¿™äº›å…¨å±€å˜é‡ï¼Œé‚£å°±å¯ä»¥é€šè¿‡ globals æ¥æŒ‡å®šã€‚æ¯”å¦‚åœ¨ react .eslintrc.js[6] é‡Œå°±æŠŠ spyOnDevã€ spyOnProd ç­‰å˜é‡æŒ‚åœ¨äº† global ä¸‹ä½œä¸ºå…¨å±€å˜é‡ï¼š

```js
{ 
    globals: { 
        spyOnDev: true, 
        spyOnProd: true, 
    } 
} 
```

å¯¹äºå®ƒçš„å€¼éœ€è¦ç‰¹åˆ«è¯´æ˜ä¸‹ï¼š

- falseã€readableã€readonly è¿™ 3 ä¸ªæ˜¯ç­‰ä»·çš„ï¼Œè¡¨ç¤ºå˜é‡åªå¯è¯»ä¸å¯å†™;
- trueã€writeableã€writable è¿™ 3 ä¸ªæ˜¯ç­‰ä»·çš„ï¼Œè¡¨ç¤ºå˜é‡å¯è¯»å¯å†™;



## é…ç½®æ‰©å±• extends

å®é™…é¡¹ç›®ä¸­é…ç½®è§„åˆ™çš„æ—¶å€™ï¼Œä¸å¯èƒ½å›¢é˜Ÿä¸€æ¡ä¸€æ¡çš„å»å•†è®®é…ç½®ï¼Œå¤ªè´¹ç²¾åŠ›äº†ã€‚é€šå¸¸çš„åšæ³•æ˜¯ä½¿ç”¨ä¸šå†…å¤§å®¶æ™®é€šä½¿ç”¨çš„ã€éµå¾ªçš„ç¼–ç è§„èŒƒ;ç„¶åé€šè¿‡ extends å»å¼•å…¥è¿™äº›è§„èŒƒã€‚extends é…ç½®çš„æ—¶å€™æ¥å—å­—ç¬¦ä¸²æˆ–è€…æ•°ç»„ï¼š

```js
{ 
    extends: [ 
        'eslint:recommended', 
        'plugin:vue/essential', 
        'eslint-config-standard', // å¯ä»¥ç¼©å†™æˆ 'standard' 
        '@vue/prettier', 
        './node_modules/coding-standard/.eslintrc-es6' 
    ] 
} 
```

### ä»ä¸Šé¢çš„é…ç½®ï¼Œå¯ä»¥çŸ¥é“ extends æ”¯æŒçš„é…ç½®ç±»å‹å¯ä»¥æ˜¯ä»¥ä¸‹å‡ ç§

- eslint å¼€å¤´çš„ï¼šæ˜¯ ESLint å®˜æ–¹çš„æ‰©å±•;
- plugin å¼€å¤´çš„ï¼šæ˜¯æ’ä»¶ç±»å‹æ‰©å±•ï¼Œæ¯”å¦‚ plugin:vue/essential;
- eslint-config å¼€å¤´çš„ï¼šæ¥è‡ª npm åŒ…ï¼Œä½¿ç”¨æ—¶å¯ä»¥çœç•¥å‰ç¼€ eslint-config-ï¼Œæ¯”å¦‚ä¸Šé¢çš„å¯ä»¥ç›´æ¥å†™æˆ standard;
- @å¼€å¤´çš„ï¼šæ‰©å±•å’Œ eslint-config ä¸€æ ·ï¼Œåªæ˜¯åœ¨ npm åŒ…ä¸Šé¢åŠ äº†ä¸€å±‚ä½œç”¨åŸŸ scope;
- ä¸€ä¸ªæ‰§è¡Œé…ç½®æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„æˆ–ç»å¯¹è·¯å¾„;

é‚£æœ‰å“ªäº›å¸¸ç”¨çš„ã€æ¯”è¾ƒè‘—åæ‰©å±•å¯ä»¥è¢« extends å¼•å…¥å‘¢

- eslint:recommendedï¼šESLint å†…ç½®çš„æ¨èè§„åˆ™ï¼Œå³ ESLint Rules åˆ—è¡¨ä¸­æ‰“äº†é’©çš„é‚£äº›è§„åˆ™;
- eslint:allï¼šESLint å†…ç½®çš„æ‰€æœ‰è§„åˆ™;
- eslint-config-standard[7]ï¼šstandard çš„ JS è§„èŒƒ;
- eslint-config-prettier[8]ï¼šå…³é—­å’Œ ESLint ä¸­ä»¥åŠå…¶ä»–æ‰©å±•ä¸­æœ‰å†²çªçš„è§„åˆ™;
- eslint-config-airbnb-baseï¼šairbab çš„ JS è§„èŒƒ;
- eslint-config-alloy[9]ï¼šè…¾è®¯ AlloyTeam å‰ç«¯å›¢é˜Ÿå‡ºå“ï¼Œå¯ä»¥å¾ˆå¥½çš„é’ˆå¯¹ä½ é¡¹ç›®çš„æŠ€æœ¯æ ˆè¿›è¡Œé…ç½®é€‰æ‹©ï¼Œæ¯”å¦‚å¯ä»¥é€‰ Reactã€Vue(ç°å·²æ”¯æŒ Vue 3.0)ã€TypeScript ç­‰;



## ä½¿ç”¨æ’ä»¶ plugins

### ESLint æä¾›æ’ä»¶æ˜¯å¹²å˜›ç”¨çš„

ESLint è™½ç„¶å¯ä»¥å®šä¹‰å¾ˆå¤šçš„ rulesï¼Œä»¥åŠé€šè¿‡ extends æ¥å¼•å…¥æ›´å¤šçš„è§„åˆ™ï¼Œä½†æ˜¯è¯´åˆ°åº•åªæ˜¯æ£€æŸ¥ JS è¯­æ³•ã€‚å¦‚æœéœ€è¦æ£€æŸ¥ Vue ä¸­çš„ template æˆ–è€… React ä¸­çš„ jsxï¼Œå°±æŸæ‰‹æ— ç­–äº†ã€‚æ‰€ä»¥å¼•å…¥æ’ä»¶çš„ç›®çš„å°±æ˜¯ä¸ºäº†å¢å¼º ESLint çš„æ£€æŸ¥èƒ½åŠ›å’ŒèŒƒå›´ã€‚

### å¦‚ä½•é…ç½®æ’ä»¶

ESLint ç›¸å…³çš„æ’ä»¶çš„å‘½åå½¢å¼æœ‰ 2 ç§ï¼šä¸å¸¦å‘½åç©ºé—´çš„å’Œå¸¦å‘½åç©ºé—´çš„ï¼Œæ¯”å¦‚ï¼š

- eslint-plugin- å¼€å¤´çš„å¯ä»¥çœç•¥è¿™éƒ¨åˆ†å‰ç¼€;
- @/ å¼€å¤´çš„;

```js
{ 
    plugins: [ 
        'jquery',          // æ˜¯æŒ‡ eslint-plugin-jquery 
        '@jquery/jquery',  // æ˜¯æŒ‡ @jquery/eslint-plugin-jquery 
        '@foobar',         // æ˜¯æŒ‡ @foobar/eslint-plugin 
    ] 
} 
```

å½“éœ€è¦åŸºäºæ’ä»¶è¿›è¡Œ extends å’Œ rules çš„é…ç½®çš„æ—¶å€™ï¼Œéœ€è¦åŠ ä¸Šæ’ä»¶çš„å¼•ç”¨ï¼Œæ¯”å¦‚ï¼š

```js
{ 
    plugins: [ 
        'jquery',   // eslint-plugin-jquery 
        '@foo/foo', // @foo/eslint-plugin-foo 
        '@bar,      // @bar/eslint-plugin 
    ], 
    extends: [ 
        'plugin:jquery/recommended', 
        'plugin:@foo/foo/recommended', 
        'plugin:@bar/recommended' 
    ], 
    rules: { 
        'jquery/a-rule': 'error', 
        '@foo/foo/some-rule': 'error', 
        '@bar/another-rule': 'error' 
    }, 
} 
```

ä»¥ä¸Šé…ç½®æ¥è‡ª ESLint plugins[10]



## é…ç½®è§„åˆ™ rules

ESLint æä¾›äº†å¤§é‡å†…ç½®çš„è§„åˆ™ï¼Œè¿™é‡Œæ˜¯å®ƒçš„è§„åˆ™åˆ—è¡¨ ESLint Rulesï¼Œé™¤æ­¤ä¹‹å¤–ä½ è¿˜å¯ä»¥é€šè¿‡æ’ä»¶æ¥æ·»åŠ æ›´å¤šçš„è§„åˆ™ã€‚

### è§„åˆ™çš„æ ¡éªŒè¯´æ˜ï¼Œæœ‰ 3 ä¸ªæŠ¥é”™ç­‰çº§

- off æˆ– 0ï¼šå…³é—­å¯¹è¯¥è§„åˆ™çš„æ ¡éªŒ;
- warn æˆ– 1ï¼šå¯ç”¨è§„åˆ™ï¼Œä¸æ»¡è¶³æ—¶æŠ›å‡ºè­¦å‘Šï¼Œä¸”ä¸ä¼šé€€å‡ºç¼–è¯‘è¿›ç¨‹;
- error æˆ– 2ï¼šå¯ç”¨è§„åˆ™ï¼Œä¸æ»¡è¶³æ—¶æŠ›å‡ºé”™è¯¯ï¼Œä¸”ä¼šé€€å‡ºç¼–è¯‘è¿›ç¨‹;

é€šå¸¸è§„åˆ™åªéœ€è¦é…ç½®å¼€å¯è¿˜æ˜¯å…³é—­å³å¯;ä½†æ˜¯ä¹Ÿæœ‰äº›è§„åˆ™å¯ä»¥ä¼ å…¥å±æ€§ï¼Œæ¯”å¦‚ï¼š

```js
{ 
    rules: { 
        'quotes': ['error', 'single'],  // å¦‚æœä¸æ˜¯å•å¼•å·ï¼Œåˆ™æŠ¥é”™ 
        'one-var': ['error', { 
            'var': 'always',  // æ¯ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­ï¼Œåªå…è®¸ 1 ä¸ª var å£°æ˜ 
            'let': 'never',   // æ¯ä¸ªå—ä½œç”¨åŸŸä¸­ï¼Œå…è®¸å¤šä¸ª let å£°æ˜ 
            'const': 'never', // æ¯ä¸ªå—ä½œç”¨åŸŸä¸­ï¼Œå…è®¸å¤šä¸ª const å£°æ˜ 
        }] 
    } 
} 
```

å¦‚ä½•çŸ¥é“æŸä¸ªæ‰©å±•æœ‰å“ªäº›è§„åˆ™å¯ä»¥é…ç½®ï¼Œä»¥åŠæ¯ä¸ªè§„åˆ™å…·ä½“é™åˆ¶?è¿™é‡Œç›´æ¥ç»™å‡ºä¸šå†…è‘—åä¸”ä½¿ç”¨æ¯”è¾ƒå¤šçš„è§„åˆ™åˆ—è¡¨çš„å¿«é€Ÿé“¾æ¥ï¼š

- ESLint rulesï¼Œè¿™æ•´ä¸ªåˆ—è¡¨å¯¹åº” eslint:allï¼Œè€Œæ‰“é’© âœ”ï¸ çš„æ˜¯ eslint:recommenmed;
- Prettier rules
- standard rules
- airbnb rules
- AlloyTeam vue rules

### è§„åˆ™çš„ä¼˜å…ˆçº§

- å¦‚æœ extends é…ç½®çš„æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆæœ€ç»ˆä¼šå°†æ‰€æœ‰è§„åˆ™é¡¹è¿›è¡Œåˆå¹¶ï¼Œå‡ºç°å†²çªçš„æ—¶å€™ï¼Œåé¢çš„ä¼šè¦†ç›–å‰é¢çš„;
- é€šè¿‡ rules å•ç‹¬é…ç½®çš„è§„åˆ™ä¼˜å…ˆçº§æ¯” extends é«˜;



## å…¶ä»–é…ç½®

### é…ç½®å½“å‰ç›®å½•ä¸º root

ESLint æ£€æµ‹é…ç½®æ–‡ä»¶æ­¥éª¤ï¼š

1. åœ¨è¦æ£€æµ‹çš„æ–‡ä»¶åŒä¸€ç›®å½•é‡Œå¯»æ‰¾ .eslintrc.* å’Œ package.json;
2. ç´§æ¥ç€åœ¨çˆ¶çº§ç›®å½•é‡Œå¯»æ‰¾ï¼Œä¸€ç›´åˆ°æ–‡ä»¶ç³»ç»Ÿçš„æ ¹ç›®å½•;
3. å¦‚æœåœ¨å‰ä¸¤æ­¥å‘ç°æœ‰ rootï¼štrue çš„é…ç½®ï¼Œåœæ­¢åœ¨çˆ¶çº§ç›®å½•ä¸­å¯»æ‰¾ .eslintrc;
4. å¦‚æœä»¥ä¸Šæ­¥éª¤éƒ½æ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™å›é€€åˆ°ç”¨æˆ·ä¸»ç›®å½• ~/.eslintrc ä¸­è‡ªå®šä¹‰çš„é»˜è®¤é…ç½®;

é€šå¸¸æˆ‘ä»¬éƒ½ä¹ æƒ¯æŠŠ ESLint é…ç½®æ–‡ä»¶æ”¾åˆ°é¡¹ç›®æ ¹ç›®å½•ï¼Œå› æ­¤å¯ä»¥ä¸ºäº†é¿å… ESLint æ ¡éªŒçš„æ—¶å€™å¾€çˆ¶çº§ç›®å½•æŸ¥æ‰¾é…ç½®æ–‡ä»¶ï¼Œæ‰€ä»¥éœ€è¦åœ¨é…ç½®æ–‡ä»¶ä¸­åŠ ä¸Š root: trueã€‚

```js
{    
root: true,
} 
```

### æ·»åŠ å…±äº«æ•°æ®

ESLint æ”¯æŒåœ¨é…ç½®æ–‡ä»¶æ·»åŠ å…±äº«è®¾ç½®ï¼Œä½ å¯ä»¥æ·»åŠ  settings å¯¹è±¡åˆ°é…ç½®æ–‡ä»¶ï¼Œå®ƒå°†æä¾›ç»™æ¯ä¸€ä¸ªå°†è¢«æ‰§è¡Œçš„è§„åˆ™ã€‚å¦‚æœä½ æƒ³æ·»åŠ çš„è‡ªå®šä¹‰è§„åˆ™è€Œä¸”ä½¿å®ƒä»¬å¯ä»¥è®¿é—®åˆ°ç›¸åŒçš„ä¿¡æ¯ï¼Œè¿™å°†ä¼šå¾ˆæœ‰ç”¨ï¼Œå¹¶ä¸”å¾ˆå®¹æ˜“é…ç½®ï¼š

```js
{ 
    settings: { 
        sharedData: 'Hello' 
    },  
} 
```

å‚è€ƒï¼šESLinté…ç½®æ–‡ä»¶.eslintrcå‚æ•°è¯´æ˜[11]

### é’ˆå¯¹ä¸ªåˆ«æ–‡ä»¶è®¾ç½®æ–°çš„æ£€æŸ¥è§„åˆ™

æ¯”å¦‚ webpack çš„ä¸­åŒ…å«äº†æŸäº›è¿è¡Œæ—¶çš„ JS æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶æ˜¯åªè·‘åœ¨æµè§ˆå™¨ç«¯çš„ï¼Œæ‰€ä»¥éœ€è¦é’ˆå¯¹è¿™éƒ¨åˆ†æ–‡ä»¶è¿›è¡Œå·®å¼‚åŒ–é…ç½®ï¼š

```js
overrides: [ 
    { 
        files: ["lib/**/*.runtime.js", "hot/*.js"], 
        env: { 
            es6: false, 
            browser: true 
        }, 
            globals: { 
            Promise: false 
        }, 
        parserOptions: { 
            ecmaVersion: 5 
        } 
    } 
] 
```

ä»¥ä¸Šé…ç½®æ¥è‡ª webpack .eslintrc.js[12]

### å¦‚ä½•æ ¡éªŒ

ä¸Šé¢ç»†è¯´äº† ESLint çš„å„ç§é…ç½®é¡¹ï¼Œä»¥åŠé’ˆå¯¹ Vue é¡¹ç›®å¦‚ä½•è¿›è¡Œå·®å¼‚é…ç½®çš„è¯´æ˜ã€‚

ç°åœ¨æˆ‘ä»¬çŸ¥é“äº†å¦‚ä½•é…ç½®ï¼Œä½†æ˜¯ä½ çŸ¥é“è¿™äº›é…ç½®éƒ½æ˜¯é…ç½®åˆ°å“ªé‡Œçš„å—?



## é…ç½®æ–¹å¼

ESLint æ”¯æŒ 3 ç§é…ç½®æ–¹å¼ï¼š

- å‘½ä»¤è¡Œï¼šä¸æ¨èï¼Œä¸åšä»‹ç»;
- å•æ–‡ä»¶å†…æ³¨é‡Šï¼šä¸æ¨èï¼Œä¸åšä»‹ç»;
- é…ç½®æ–‡ä»¶ï¼šé…ç½®æ–‡ä»¶çš„ç±»å‹å¯ä»¥æ˜¯å¥½å‡ ç§ï¼Œæ¯”å¦‚ï¼š.jsã€.ymlã€json ç­‰ã€‚æ¨èä½¿ç”¨ .eslintrc.js;

ä¸‹é¢é€šè¿‡å‘½ä»¤æ¥ç”Ÿæˆä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼š

```js
# å®‰è£… eslint 
npm i eslint -D 
 
# åˆå§‹åŒ–ä¸€ä¸ªé…ç½®æ–‡ä»¶ 
npx eslint --init 
```

æœ€åä¼šåœ¨å½“å‰ç›®å½•ç”Ÿæˆä¸€ä¸ª .eslintrc.js æ–‡ä»¶ã€‚è¿™é‡Œå°±ä¸æŠŠä»£ç è´´å‡ºæ¥äº†ï¼Œæ²¡å‚è€ƒæ„ä¹‰ã€‚

ä¸Šé¢æˆ‘ä»¬çŸ¥é“äº†å¯ä»¥å°†é…ç½®ç»Ÿä¸€å†™åˆ°ä¸€ä¸ªé…ç½®æ–‡ä»¶é‡Œï¼Œä½†æ˜¯ä½ çŸ¥é“è¯¥å¦‚ä½•å»è§¦å‘è¿™ä¸ªé…ç½®æ–‡ä»¶çš„æ ¡éªŒè§„åˆ™å˜›?



## æ ¡éªŒå•ä¸ªæ–‡ä»¶

```js
// æ ¡éªŒ a.js å’Œ b.js 
npx eslint a.js b.js 
 
// æ ¡éªŒ src å’Œ scripts ç›®å½• 
npx eslint src scripts 
```



## æ ¡éªŒåˆ«çš„ç±»å‹çš„æ–‡ä»¶

é€šå¸¸ ESLint åªèƒ½æ ¡éªŒ JS æ–‡ä»¶ã€‚æ¯”å¦‚éœ€è¦æ ¡éªŒ .vue æ–‡ä»¶ï¼Œå…‰é…ç½® vue æ’ä»¶å’Œ vue-eslint-parser è§£æå™¨æ˜¯ä¸å¤Ÿçš„ï¼Œè¿˜éœ€è¦è®© ESLint åœ¨æŸ¥æ‰¾æ–‡ä»¶çš„æ—¶å€™æ‰¾åˆ° .vue æ–‡ä»¶ã€‚

å¯ä»¥é€šè¿‡ --ext æ¥æŒ‡å®šå…·ä½“éœ€è¦æ ¡éªŒçš„æ–‡ä»¶ï¼š

```js
npx eslint --ext .js,.jsx,.vue src 
```



## è‡ªåŠ¨ä¿®å¤éƒ¨åˆ†æ ¡éªŒé”™è¯¯çš„ä»£ç 

rules åˆ—è¡¨é¡¹ä¸­æ ‡è¯†äº†ä¸€ä¸ªæ‰³æ‰‹ ğŸ”§ å›¾æ¡ˆçš„è§„åˆ™å°±æ ‡è¯†è¯¥è§„åˆ™æ˜¯å¯ä»¥é€šè¿‡ ESLint å·¥å…·è‡ªåŠ¨ä¿®å¤ä»£ç çš„ã€‚å¦‚ä½•è‡ªåŠ¨ä¿®å¤å‘¢?é€šè¿‡ --fix å³å¯ã€‚æ¯”å¦‚å¯¹äº ESLint Rules é‡Œçš„è¿™ä¸ª semi è§„åˆ™ï¼Œå®ƒå°±æ˜¯å¸¦æ‰³æ‰‹å›¾æ¡ˆçš„ã€‚

å¯¹äºå¦‚ä¸‹çš„ a.js ä»£ç ï¼š

```js
const num = 12 
```

å½“åœ¨é…ç½®æ–‡ä»¶é…ç½®äº† 'semi': [2, 'always'] åï¼Œè¿è¡Œå‘½ä»¤ï¼š

```js
npx eslint --fix a.js 
```

æ ¡éªŒç›´æ¥å°±é€šè¿‡äº†ï¼Œä¸”ä¼šè‡ªåŠ¨ä¿®å¤ä»£ç ï¼Œåœ¨ä»£ç æœ«å°¾è‡ªåŠ¨åŠ ä¸Šåˆ†å·ã€‚



## æŠŠæ ¡éªŒå‘½ä»¤åŠ åˆ° package.json

æ£€éªŒå‘½ä»¤æ¯”è¾ƒé•¿ï¼Œä¹Ÿéš¾è®°ï¼Œä¹ æƒ¯ä¸Šä¼šæŠŠè¿™äº›å‘½åç›´æ¥å†™åˆ° package.json é‡Œï¼š

```js
{ 
    "scripts": { 
        "lint": "npx eslint --ext .js,.jsx,.vue src", 
        "lint:fix": "npx eslint --fix --ext .js,.jsx,.vue src", 
    } 
} 
```



## è¿‡æ»¤ä¸€äº›ä¸éœ€è¦æ ¡éªŒçš„æ–‡ä»¶

å¯¹äºä¸€äº›å…¬å…±çš„ JSã€æµ‹è¯•è„šæœ¬æˆ–è€…æ˜¯ç‰¹å®šç›®å½•ä¸‹çš„æ–‡ä»¶ä¹ æƒ¯ä¸Šæ˜¯ä¸éœ€è¦æ ¡éªŒçš„ï¼Œå› æ­¤å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•é€šè¿‡åˆ›å»ºä¸€ä¸ª .eslintignore æ–‡ä»¶æ¥é…ç½®ï¼Œå‘Šè¯‰ ESLint æ ¡éªŒçš„æ—¶å€™å¿½ç•¥å®ƒä»¬ï¼š

```js
public/ 
src/main.js 
```

é™¤äº† .eslintignore ä¸­æŒ‡å®šçš„æ–‡ä»¶æˆ–ç›®å½•ï¼ŒESLint æ€»æ˜¯å¿½ç•¥ /node_modules/ å’Œ /bower_components/ ä¸­çš„æ–‡ä»¶;å› æ­¤å¯¹äºä¸€äº›ç›®å‰è§£å†³ä¸äº†çš„è§„åˆ™æŠ¥é”™ï¼Œä½†æ˜¯å¦‚æœåˆæ€¥äºæ‰“åŒ…ä¸Šçº¿ï¼Œåœ¨ä¸å½±å“è¿è¡Œçš„æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨ .eslintignore æ–‡ä»¶å°†å…¶æš‚æ—¶å¿½ç•¥ã€‚

### åœ¨ Vue é¡¹ç›®ä¸­çš„å®è·µ

ä¸Šé¢æŠŠ ESLint çš„å‡ ä¹æ‰€æœ‰çš„é…ç½®å‚æ•°å’Œæ ¡éªŒæ–¹å¼éƒ½è¯¦ç»†çš„ä»‹ç»äº†ä¸€éï¼Œä½†æ˜¯å¦‚æœæƒ³åœ¨é¡¹ç›®ä¸­è½åœ°ï¼Œä»…ä»…é ä¸Šé¢çš„çŸ¥è¯†è¿˜æ˜¯ä¸å¤Ÿçš„ã€‚ä¸‹é¢å°†ç»†è¯´å¦‚ä½•åœ¨ Vue ä¸­è½åœ°ä»£ç æ ¡éªŒã€‚

å…³äºå¦‚ä½•åœ¨ Vue ä¸­è½åœ°ä»£ç æ ¡éªŒï¼Œä¸€èˆ¬æ˜¯æœ‰ 2 ç§æƒ…å†µï¼š

- é€šè¿‡ vue-cli åˆå§‹åŒ–é¡¹ç›®çš„æ—¶å€™å·²ç»é€‰æ‹©äº†å¯¹åº”çš„æ ¡éªŒé…ç½®
- å¯¹äºä¸€ä¸ªç©ºçš„ Vue é¡¹ç›®ï¼Œæƒ³æ¥å…¥ä»£ç æ ¡éªŒ

å…¶å®è¿™ 2 ç§æƒ…å†µæœ€ç»ˆçš„æ ¡éªŒçš„æ ¸å¿ƒé…ç½®éƒ½æ˜¯ä¸€æ ·çš„ï¼Œåªæ˜¯åˆšå¼€å§‹çš„æ—¶å€™å®‰è£…çš„åŒ…æœ‰æ‰€åŒºåˆ«ã€‚ä¸‹é¢é€šè¿‡åˆ†æ vue-cli é…ç½®çš„ä»£ç æ ¡éªŒï¼Œæ¥çœ‹çœ‹å®ƒåˆ°åº•åšäº†å“ªäº›äº‹æƒ…ï¼Œé€šè¿‡å®ƒå®‰è£…çš„åŒ…ä»¥åŠåŒ…çš„ä½œç”¨ï¼Œæˆ‘ä»¬å°±ä¼šçŸ¥é“å¦‚ä½•åœ¨ç©ºé¡¹ç›®ä¸­é…ç½®ä»£ç æ ¡éªŒäº†ã€‚



## é€šè¿‡ vue-cli åˆå§‹åŒ–çš„é¡¹ç›®

å¦‚æœä½ çš„é¡¹ç›®æœ€åˆæ˜¯é€šè¿‡ vue-cli æ–°å»ºçš„ï¼Œé‚£ä¹ˆåœ¨æ–°å»ºçš„æ—¶å€™ä¼šè®©ä½ é€‰

- æ˜¯å¦æ”¯æŒ eslint;
- æ˜¯å¦å¼€å¯ä¿å­˜æ ¡éªŒ;
- æ˜¯å¦å¼€å¯æäº¤å‰æ ¡éªŒ;

å¦‚æœéƒ½å¼€å¯äº†è¯ï¼Œä¼šå®‰è£…å¦‚ä¸‹å‡ ä¸ªåŒ…ï¼š

- eslintï¼šå‰é¢ 2 å¤§ç« èŠ‚ä»‹ç»çš„å°±æ˜¯è¿™ç©æ„ï¼ŒESLint å‡ºå“ï¼Œæ˜¯ä»£ç æ ¡éªŒçš„åŸºç¡€åŒ…ï¼Œä¸”æä¾›äº†å¾ˆå¤šå†…ç½®çš„ Rulesï¼Œæ¯”å¦‚ eslint:recommended ç»å¸¸è¢«ä½œä¸ºé¡¹ç›®çš„ JS æ£€æŸ¥è§„èŒƒè¢«å¼•å…¥;
- babel-eslintï¼šä¸€ä¸ªå¯¹ Babel è§£æå™¨çš„åŒ…è£…ï¼Œä½¿å…¶èƒ½å¤Ÿä¸ ESLint å…¼å®¹;
- lint-stagedï¼šè¯·çœ‹åé¢ pre-commit éƒ¨åˆ†;
- @vue/cli-plugin-eslint
- eslint-plugin-vue

ä¸‹é¢é‡ç‚¹ä»‹ç» @vue/cli-plugin-eslint å’Œ eslint-plugin-vueï¼Œè¯´ä¸‹è¿™ 2 ä¸ªåŒ…æ˜¯å¹²å˜›çš„ã€‚

### @vue/cli-plugin-eslint

è¿™ä¸ªåŒ…å®ƒä¸»è¦å¹²äº† 2 ä»¶äº‹æƒ…ï¼š

### ç¬¬ä¸€ä»¶äº‹

å¾€ package.json é‡Œæ³¨å†Œäº†ä¸€ä¸ªå‘½ä»¤ï¼š

```js
{ 
    "scripts": { 
        "lint": "vue-cli-service lint" 
    } 
} 
```

æ‰§è¡Œè¿™ä¸ªå‘½ä»¤ä¹‹åï¼Œå®ƒä¼šå»æ£€æŸ¥å’Œä¿®å¤éƒ¨åˆ†å¯ä»¥ä¿®å¤çš„é—®é¢˜ã€‚é»˜è®¤æŸ¥æ‰¾çš„æ–‡ä»¶æ˜¯ src å’Œ tests ç›®å½•ä¸‹æ‰€æœ‰çš„ .js,.jsx,.vue æ–‡ä»¶ï¼Œä»¥åŠé¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰€æœ‰çš„ js æ–‡ä»¶(æ¯”å¦‚ï¼Œä¹Ÿä¼šæ£€æŸ¥ .eslintrc.js)ã€‚

å½“ç„¶ä½ ä¹Ÿå¯ä»¥è‡ªå®šä¹‰çš„ä¼ å…¥å‚æ•°å’Œæ ¡éªŒæ–‡ä»¶ï¼š

```js
vue-cli-service lint [options] [...files] 
```

æ”¯æŒçš„å‚æ•°å¦‚ä¸‹ï¼š

- --no-fix: ä¸ä¼šä¿®å¤ errors å’Œ warnings;
- --max-errors [limit]ï¼šæŒ‡å®šå¯¼è‡´å‡ºç° npm ERR é”™è¯¯çš„æœ€å¤§ errors æ•°é‡;

### ç¬¬äºŒä»¶äº‹

å¢åŠ äº†ä»£ç ä¿å­˜è§¦å‘æ ¡éªŒçš„åŠŸèƒ½ lintOnSaveï¼Œè¿™ä¸ªåŠŸèƒ½é»˜è®¤æ˜¯å¼€å¯çš„ã€‚å¦‚æœæƒ³è¦å…³é—­è¿™ä¸ªåŠŸèƒ½ï¼Œå¯ä»¥åœ¨ vue.config.js é‡Œé…ç½®ï¼Œä¹ æƒ¯ä¸Šåªå¼€å¯ development ç¯å¢ƒä¸‹çš„ä»£ç ä¿å­˜æ ¡éªŒåŠŸèƒ½ï¼š

```js
module.exports = { 
    lintOnSave: process.env.NODE_ENV === 'development', 
} 
```

lintOnSave å‚æ•°è¯´æ˜ï¼š

- true æˆ–è€… warningï¼šå¼€å¯ä¿å­˜æ ¡éªŒï¼Œä¼šå°† errors çº§åˆ«çš„é”™è¯¯åœ¨ç»ˆç«¯ä¸­ä»¥ WARNING çš„å½¢å¼æ˜¾ç¤ºã€‚é»˜è®¤çš„ï¼ŒWARNING å°†ä¸ä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥;
- falseï¼šä¸å¼€å¯ä¿å­˜æ ¡éªŒ;
- errorï¼šå¼€å¯ä¿å­˜æ ¡éªŒï¼Œä¼šå°† errors çº§åˆ«çš„é”™è¯¯åœ¨ç»ˆç«¯ä¸­ä»¥ ERROR çš„å½¢å¼å‡ºç°ï¼Œä¼šå¯¼è‡´ç¼–è¯‘å¤±è´¥ï¼ŒåŒæ—¶æµè§ˆå™¨é¡µé¢å˜é»‘ï¼Œæ˜¾ç¤º Failed to compileã€‚

### eslint-plugin-vue

eslint-plugin-vue æ˜¯å¯¹ .vue æ–‡ä»¶è¿›è¡Œä»£ç æ ¡éªŒçš„æ’ä»¶ã€‚

é’ˆå¯¹è¿™ä¸ªæ’ä»¶ï¼Œå®ƒæä¾›äº†è¿™å‡ ä¸ªæ‰©å±•

- plugin:vue/baseï¼šåŸºç¡€
- plugin:vue/essentialï¼šé¢„é˜²é”™è¯¯çš„(ç”¨äº Vue 2.x)
- plugin:vue/recommendedï¼šæ¨èçš„ï¼Œæœ€å°åŒ–ä»»æ„é€‰æ‹©å’Œè®¤çŸ¥å¼€é”€(ç”¨äº Vue 2.x);
- plugin:vue/strongly-recommendedï¼šå¼ºçƒˆæ¨èï¼Œæé«˜å¯è¯»æ€§(ç”¨äº Vue 2.x);
- plugin:vue/vue3-essentialï¼š(ç”¨äº Vue 3.x)
- plugin:vue/vue3-strongly-recommendedï¼š(ç”¨äº Vue 3.x)
- plugin:vue/vue3-recommendedï¼š(ç”¨äº Vue 3.x)

å„æ‰©å±•è§„åˆ™åˆ—è¡¨ï¼švue rules

### çœ‹åˆ°è¿™ä¹ˆä¸€å †çš„æ‰©å±•ï¼Œæ˜¯ä¸æ˜¯éƒ½ä¸çŸ¥é“é€‰å“ªä¸ªäº†

ä»£ç è§„èŒƒçš„ä¸œè¥¿ï¼ŒåŸåˆ™è¿˜æ˜¯å¾—ç”±å„è‡ªçš„å›¢é˜Ÿå»ç£¨åˆå•†è®®å‡ºä¸€å¥—é€‚åˆå¤§å®¶çš„è§„åˆ™ã€‚ä¸è¿‡ï¼Œå¦‚æœä½ ç”¨çš„æ˜¯ Vue2ï¼Œæˆ‘è¿™é‡Œå¯ä»¥æ¨è 2 å¥— extends é…ç½®ï¼š

```js
{ 
    // Vue å®˜æ–¹ç¤ºä¾‹ä¸Šçš„é…ç½® 
   extends: ['eslint:recommended', 'plugin:vue/recommended'],   
    
   // æˆ–è€…ä½¿ç”¨ AlloyTeam å›¢é˜Ÿé‚£å¥— 
   extends: ['alloy', 'alloy/vue'] 
} 
```

### é…ç½®å’Œæ’ä»¶å¯¹åº”çš„è§£æå™¨

å¦‚æœæ˜¯ Vue 2.x é¡¹ç›®ï¼Œé…ç½®äº† eslint-plugin-vue æ’ä»¶å’Œ extends åï¼Œtemplate æ ¡éªŒè¿˜æ˜¯ä¼šå¤±æ•ˆï¼Œå› ä¸ºä¸ç®¡æ˜¯ ESLint é»˜è®¤çš„è§£æå™¨ Espree è¿˜æ˜¯ babel-eslint éƒ½åªèƒ½è§£æ JSï¼Œæ— æ³•è§£æ template çš„å†…å®¹ã€‚

è€Œ vue-eslint-parser åªèƒ½è§£æ template çš„å†…å®¹ï¼Œä½†æ˜¯ä¸ä¼šè§£æ JSï¼Œå› æ­¤è¿˜éœ€è¦å¯¹è§£æå™¨åšå¦‚ä¸‹é…ç½®ï¼š

```js
{ 
    parser: 'vue-eslint-parser', 
    parseOptions: { 
        parser: 'babel-eslint', 
        ecmaVersion: 12, 
        sourceType: 'module' 
    }, 
    extends: [ 
        'eslint:recommended',  
        'plugin:vue/recommended' 
    ], 
    plugins: ['vue'] 
} 
```

å‚è€ƒï¼šeslint-plugin-vue faq[13]



## è®© Prettier ç®¡æ§ä»£ç é£æ ¼

é’ˆå¯¹ Prettier ä¸å¾—ä¸æå‡ºä»¥ä¸‹ç–‘é—®?

- Prettier æ˜¯ä»€ä¹ˆ?
- ä¸ºä»€ä¹ˆæœ‰äº† ESLintï¼Œè¿˜éœ€è¦å¼•å…¥ Prettier å‘¢?å®ƒä¸¤ä¹‹é—´æœ‰ä»€ä¹ˆåŒºåˆ«?
- å¦‚ä½•é…ç½® Prettier?
- Prettier å¦‚ä½•å’Œ ESLint ç»“åˆä½¿ç”¨?
- Prettier æ˜¯ä»€ä¹ˆ

ç”¨å®ƒè‡ªå·±çš„è¯æ¥è¯´ï¼šæˆ‘æ˜¯ä¸€ä¸ªè‡ªä»¥ä¸ºæ˜¯çš„ä»£ç æ ¼å¼åŒ–å·¥å…·ï¼Œè€Œä¸”æˆ‘æ”¯æŒçš„æ–‡ä»¶ç±»å‹å¾ˆå¤šï¼Œæ¯”å¦‚ï¼š

- JavaScript(åŒ…æ‹¬å®éªŒä¸­çš„ç‰¹æ€§)
- JSX
- Vue
- TypeScript
- CSSã€Lessã€SCSS
- HTML
- JSON
- Markdown

ä»¥åŠè¿˜æœ‰ä¸€äº›å…¶ä»–ç±»å‹çš„æ–‡ä»¶ã€‚

### Prettier å¯¹æ¯” ESLint

æˆ‘ä»¬çŸ¥é“ ESLint è´Ÿè´£äº†å¯¹ä»£ç çš„æ ¡éªŒåŠŸèƒ½ï¼Œå¹¶ä¸”ä¸»è¦æä¾›äº† 2 ç±»è§„åˆ™ï¼š

- æ£€æŸ¥æ ¼å¼åŒ–çš„è§„åˆ™
- æ£€æŸ¥ä»£ç è´¨é‡çš„è§„åˆ™

è¯´åˆ°åº• ESLint å°±æ˜¯é€šè¿‡ä¸€æ¡æ¡çš„è§„åˆ™å»é™åˆ¶ä»£ç çš„è§„èŒƒï¼Œä½†æ˜¯è¿™äº›è§„åˆ™æ¯•ç«Ÿæ˜¯æœ‰é™çš„ï¼Œè€Œä¸”æ›´é‡è¦çš„æ˜¯è¿™äº›è§„åˆ™çš„é‡ç‚¹å¹¶ä¸åœ¨ä»£ç é£æ ¼ä¸Šï¼Œæ‰€ä»¥å•å‡­ ESLint å¹¶ä¸èƒ½å®Œå…¨çš„ç»Ÿä¸€ä»£ç é£æ ¼ã€‚

è¿™ä¸ªæ—¶å€™å°±éœ€è¦å¼•å…¥ Prettier äº†ï¼Œå› ä¸ºå®ƒå¹²çš„äº‹å°±æ˜¯åªç®¡ä»£ç æ ¼å¼åŒ–ï¼Œä¸ç®¡ä»£ç è´¨é‡ã€‚

â€œPrettierï¼šåœ¨ä»£ç é£æ ¼è¿™ä¸€å—ï¼Œæˆ‘ä¸€ç›´æ‹¿æçš„æ­»æ­»çš„ã€‚

### å¦‚ä½•é…ç½® Prettier

åˆå§‹åŒ–æ“ä½œï¼š

```js
# å®‰è£…åŒ… 
npm i prettier -D   
 
# æ–°å»º .prettierrc.js 
echo module.exports = {} > .prettierrc.js 
 
# æ–°å»º .prettierignore 
echo > .prettierignore 
```

Prettier æ”¯æŒå¯ä»¥é…ç½®å‚æ•°ä¸å¤šï¼Œæ€»å…±æ‰ 21 ä¸ªï¼Œè¿™é‡Œæ˜¯æ‰€æœ‰å‚æ•°çš„è¯´æ˜ prettier options[14]

æ‰€æœ‰å‚æ•°éƒ½æœ‰é»˜è®¤å€¼ï¼Œä¹Ÿå°±æ˜¯è¯´å³ä½¿ä½ æ²¡æœ‰é…ç½® .prettierrc.jsï¼Œå½“ä½ ç”¨ Prettier å»æ ¼å¼åŒ–ä»£ç çš„æ—¶å€™å…¨éƒ¨éƒ½ä¼šèµ°é»˜è®¤é…ç½®ã€‚é’ˆå¯¹ä¸ªåˆ«å‚æ•°ï¼Œä½ ä¸æƒ³ç”¨é»˜è®¤è®¾ç½®çš„è¯ï¼Œå°±å¯ä»¥åœ¨ .prettierrc.js é…ç½®å…·ä½“æƒ³è¦çš„å€¼ã€‚

å¦‚ä¸‹ï¼ŒæŠŠé¡¹ç›®ä¸­ä¼šç”¨åˆ°çš„å‚æ•°è¿›è¡Œä¸€ä¸ªè¯´æ˜ï¼š

```js
module.exports = { 
    printWidth: 80,                    //ï¼ˆé»˜è®¤å€¼ï¼‰å•è¡Œä»£ç è¶…å‡º 80 ä¸ªå­—ç¬¦è‡ªåŠ¨æ¢è¡Œ 
    tabWidth: 2,                       //ï¼ˆé»˜è®¤å€¼ï¼‰ä¸€ä¸ª tab é”®ç¼©è¿›ç›¸å½“äº 2 ä¸ªç©ºæ ¼ 
    useTabs: true,                     // è¡Œç¼©è¿›ä½¿ç”¨ tab é”®ä»£æ›¿ç©ºæ ¼ 
    semi: false,                       //ï¼ˆé»˜è®¤å€¼ï¼‰è¯­å¥çš„æœ«å°¾åŠ ä¸Šåˆ†å· 
    singleQuote: true,                 // ä½¿ç”¨å•å¼•å· 
    quoteProps: 'as-needed',           //ï¼ˆé»˜è®¤å€¼ï¼‰ä»…ä»…å½“å¿…é¡»çš„æ—¶å€™æ‰ä¼šåŠ ä¸ŠåŒå¼•å· 
    jsxSingleQuote: true,              // åœ¨ JSX ä¸­ä½¿ç”¨å•å¼•å· 
    trailingComma: 'all',              // ä¸ç”¨åœ¨å¤šè¡Œçš„é€—å·åˆ†éš”çš„å¥æ³•ç»“æ„çš„æœ€åä¸€è¡Œçš„æœ«å°¾åŠ ä¸Šé€—å· 
    bracketSpacing: true,              //ï¼ˆé»˜è®¤å€¼ï¼‰åœ¨æ‹¬å·å’Œå¯¹è±¡çš„æ–‡å­—ä¹‹é—´åŠ ä¸Šä¸€ä¸ªç©ºæ ¼ 
    jsxBracketSameLine: true,          // æŠŠ > ç¬¦å·æ”¾åœ¨å¤šè¡Œçš„ JSX å…ƒç´ çš„æœ€åä¸€è¡Œ 
    arrowParens: 'avoid',              // å½“ç®­å¤´å‡½æ•°ä¸­åªæœ‰ä¸€ä¸ªå‚æ•°çš„æ—¶å€™å¯ä»¥å¿½ç•¥æ‹¬å¼§ 
    vueIndentScriptAndStyle: false,    //ï¼ˆé»˜è®¤å€¼ï¼‰å¯¹äº .vue æ–‡ä»¶ï¼Œä¸ç¼©è¿› <script> å’Œ <style> é‡Œçš„å†…å®¹ 
    embeddedLanguageFormatting: 'off', // ä¸å…è®¸æ ¼å¼åŒ–å†…åµŒçš„ä»£ç å—ï¼Œæ¯”å¦‚ markdown  æ–‡ä»¶é‡Œçš„ä»£ç å— 
}; 
```

â€œæ‰©å±•é˜…è¯»ï¼šå…³äº Trailing commas[15] ä½ æˆ–è®¸æƒ³äº†è§£æ›´å¤šã€‚

ç„¶åå¯ä»¥é€šè¿‡å‘½ä»¤æ¥æ ¼å¼åŒ–ä»£ç ï¼š

```js
# å°†æ ¼å¼åŒ–å½“å‰ç›®å½•åŠå­ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶ 
npx prettier --write . 
 
# æ£€æŸ¥æŸä¸ªæ–‡ä»¶æ˜¯å¦å·²ç»æ ¼å¼åŒ– 
npx prettier --check src/main.js 
```

å¦‚æœæœ‰äº›æ–‡ä»¶ä¸æƒ³è¢« Prettier æ ¼å¼åŒ–ï¼Œå¯ä»¥å°†å…¶å†™å…¥åˆ° .prettierignore é‡Œï¼š

```js
build/ 
package.json 
public/ 
test/*.*  
```

### Prettier å’Œ ESLint ä¸€èµ·å¹²æ´»æ›´é…å“¦

ä¸Šé¢ä»‹ç»äº† Prettier çš„å…·ä½“é…ç½®ï¼Œè¿™é‡Œä¸»è¦ä»‹ç»å’Œ ESLint ç»“åˆä½¿ç”¨çš„é…ç½®å’Œæ³¨æ„äº‹é¡¹ã€‚

å’Œ ESLint é…åˆä½¿ç”¨éœ€è¦ç”¨åˆ° eslint-plugin-prettier è¿™ä¸ªæ’ä»¶ï¼š

```js
npm i eslint-plugin-prettier -D 
```

é…ç½®ï¼š

```js
{ 
    plugins: ['prettier'], 
    rules: { 
        'prettier/prettier': 'error' 
    } 
} 
```

è¿™ä¸ªæ’ä»¶çš„å·¥ä½œåŸç†æ˜¯å…ˆè°ƒç”¨ Prettier å¯¹ä½ çš„ä»£ç è¿›è¡Œæ ¼å¼åŒ–ï¼Œç„¶åä¼šæŠŠæ ¼å¼åŒ–å‰åä¸ä¸€è‡´çš„åœ°æ–¹è¿›è¡Œæ ‡è®°ï¼Œé€šè¿‡é…ç½® 'prettier/prettier': 'error' æ­¤æ¡è§„åˆ™ä¼šå°†æ ‡è®°åœ°æ–¹è¿›è¡Œ error çº§åˆ«çš„æŠ¥é”™æç¤ºï¼Œç„¶åå¯ä»¥é€šè¿‡ ESLint çš„ --fix è‡ªåŠ¨ä¿®å¤åŠŸèƒ½å°†å…¶ä¿®å¤ã€‚

### å†²çªäº†æ€ä¹ˆåŠ

é€šè¿‡å‰é¢çš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ ESLint ä¹Ÿæ˜¯ä¼šå¯¹ä»£ç é£æ ¼åšä¸€äº›é™åˆ¶çš„ï¼Œè€Œ Prettier ä¸»è¦å°±æ˜¯è§„èŒƒä»£ç é£æ ¼ï¼Œæ‰€ä»¥åœ¨æŠŠå®ƒä»¬ç»“åˆä¸€èµ·ä½¿ç”¨çš„æ—¶å€™æ˜¯å­˜ä¼šåœ¨ä¸€äº›é—®é¢˜çš„ã€‚å¯¹äºä¸ªåˆ«è§„åˆ™ï¼Œä¼šä½¿å¾—åŒæ–¹åœ¨æ ¡éªŒåå‡ºç°ä»£ç æ ¼å¼ä¸ä¸€è‡´çš„é—®é¢˜ã€‚

é‚£ä¹ˆå½“ Prettier å’Œ ESLint å‡ºç°å†²çªä¹‹åï¼Œè¯¥æ€ä¹ˆåŠå‘¢?

ç”¨ Prettier çš„è¯æ¥è¯´å¾ˆç®€å•ï¼Œåªè¦ä½¿ç”¨ eslint-config-prettier å°±å¯ä»¥äº†ã€‚è§£å†³å†²çªçš„æ€è·¯å°±æ˜¯é€šè¿‡å°†è¿™ä¸ªåŒ…æä¾›çš„æ‰©å±•æ”¾åˆ° extends æœ€åé¢å¼•å…¥ï¼Œä¾æ® rules ç”Ÿæ•ˆçš„ä¼˜å…ˆçº§ï¼Œæ‰€ä»¥å®ƒä¼šè¦†ç›–å‰é¢èµ·å†²çªçš„è§„åˆ™ï¼Œæ¯”å¦‚ï¼š

```js
{ 
    extends: [ 
        'eslint:recommended', 
        'prettier',  // å¿…é¡»æ”¾æœ€å 
    ], 
} 
```

é™¤äº†èƒ½è¦†ç›–å’Œ ESLint ä¸­èµ·å†²çªçš„è§„åˆ™ä¹‹å¤–ï¼Œeslint-config-prettier è¿˜èƒ½è¦†ç›–æ¥è‡ªä»¥ä¸‹æ’ä»¶çš„è§„åˆ™(åªåˆ—äº†éƒ¨åˆ†)ï¼š

- eslint-plugin-standard
- eslint-plugin-vue

é‚£ eslint-config-prettier åˆ°åº•æä¾›äº†å“ªäº›è¦†ç›–è§„åˆ™å‘¢?ç›´æ¥çœ‹è¿™ä¸ªåˆ—è¡¨ï¼šeslint-config-prettier rules

å¦‚æœæƒ³è¦†ç›–æŸäº›æ’ä»¶çš„è§„åˆ™ï¼Œéœ€è¦å¼•å…¥å¯¹åº”æ’ä»¶çš„æ‰©å±•ï¼Œæ¯”å¦‚ï¼š

```js
{ 
    extends: [ 
        'standard', 
        'plugin:vue/recommended', 
        'prettier/standard',      // è¦†ç›– eslint-config-stanard  
        'prettier/vue',           // è¦†ç›– eslint-plugin-vue  
    ], 
} 
```

â€œæç¤ºï¼šåœ¨ eslint-config-prettier 8.0.0 ç‰ˆæœ¬åï¼Œextends ä¸å†éœ€è¦ä¸ºå•ç‹¬çš„æ’ä»¶å¼•å…¥å¯¹åº”æ‰©å±•æ¥è¦†ç›–å†²çªäº†ï¼Œç»Ÿä¸€å¼•å…¥ 'prettier' å³å¯ã€‚

å¦‚æœåŒæ—¶ä½¿ç”¨äº† eslint-plugin-prettier å’Œ eslint-config-prettier å¯ä»¥è¿™ä¹ˆé…ç½®ï¼š

```js
{     
   extends: ['plugin:prettier/recommended'], 
} 
```

å®ƒå…¶å®å’Œä¸‹é¢è¿™äº›é…ç½®æ˜¯ç­‰ä»·çš„ï¼š

```js
{ 
    extends: ['prettier'],  // eslint-config-prettier æä¾›çš„ï¼Œç”¨äºè¦†ç›–èµ·å†²çªçš„è§„åˆ™ 
    plugins: ['prettier'],  // æ³¨å†Œ eslint-plugin-prettier æ’ä»¶ 
    rules: { 
        'prettier/prettier': 'error', 
        'arrow-body-style': 'off', 
        'prefer-arrow-callback': 'off' 
    } 
} 
```

æ‰€ä»¥å¦‚æœæ˜¯åœ¨ Vue 2 é¡¹ç›®ä¸­é…ç½® ESLint å’Œ Prettier ä¼šè¿™ä¹ˆé…ç½®ï¼š

```js
{ 
    parser: 'vue-eslint-parser', 
    parseOptions: { 
        parser: 'babel-eslint', 
        ecmaVersion: 12, 
        sourceType: 'module' 
    }, 
    extends: [ 
        'eslint:recommended',  
        'plugin:vue/recommended', 
        'plugin:prettier/recommended',  // åœ¨å‰é¢ Vue é…ç½®çš„åŸºç¡€ä¸ŠåŠ ä¸Šè¿™è¡Œ 
    ], 
    plugins: ['vue'] 
} 
```

å…¶å®å¦‚æœä½ çš„é¡¹ç›®æ˜¯ç”¨ vue-cli åˆå§‹åŒ–çš„ï¼Œä¸”é€‰æ‹©äº† eslint + prettier æ–¹æ¡ˆçš„è¯ï¼Œç”Ÿæˆçš„é¡¹ç›®ä¸­ï¼Œ.eslintrc.js é…ç½®æ–‡ä»¶ä¸­ extends çš„é…ç½®æ˜¯è¿™æ ·çš„ï¼š

```js
{ 
    extends: [ 
        'plugin:vue/essential', 
        'eslint:recommended',  
        '@vue/prettier' 
    ] 
} 
```

å®ƒçš„æœ€åä¸€é¡¹æ‰©å±•æ˜¯ @vue/prettierï¼Œè¿™ä¸ªå¯¹åº”çš„æ˜¯ @vue/eslint-config-prettier è¿™ä¸ªåŒ…ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹è¿™ä¸ªåŒ…ä¸‹é¢çš„ index.js å†…å®¹ï¼š

```js
{ 
    plugins: ['prettier'], 
    extends: [ 
        require.resolve('eslint-config-prettier'), 
        require.resolve('eslint-config-prettier/vue') 
    ], 
    rules: { 
        'prettier/prettier': 'warn' 
    } 
} 
```

è¿™ä¸ªå’Œæˆ‘ä»¬ä¸Šé¢é…ç½®çš„å†…å®¹æ˜¯ç›¸å·®æ— å‡ çš„ï¼Œè€Œå¼•å…¥ eslint-config-prettier/vue æ˜¯å› ä¸ºè¿™ä¸ª @vue/eslint-config-prettier åŒ…ä¾èµ–çš„ eslint-config-prettier ç‰ˆæœ¬æ˜¯ ^6.0.0 ç‰ˆæœ¬çš„ï¼Œæ‰€ä»¥åœ¨å¤„ç†å†²çªçš„æ—¶å€™éœ€è¦ç‰¹åˆ«æŒ‡å®šå’Œå¯¹åº”ç±»å‹æ’ä»¶åŒ¹é…çš„æ‰©å±•ã€‚



## è®© EditorConfig åŠ©åŠ›å¤šç¼–è¾‘å™¨å¼€å‘å§

EditorConfig[16] æ˜¯ä¸ªå•¥ç©æ„?å®ƒå¯ä»¥å¯¹å¤šç§ç±»å‹çš„å•æ–‡ä»¶è¿›è¡Œç®€å•çš„æ ¼å¼åŒ–ï¼Œå®ƒæä¾›çš„é…ç½®å‚æ•°å¾ˆå°‘ï¼š

```js
# å‘Šè¯‰ EditorConfig æ’ä»¶ï¼Œè¿™æ˜¯æ ¹æ–‡ä»¶ï¼Œä¸ç”¨ç»§ç»­å¾€ä¸ŠæŸ¥æ‰¾ 
root = true 
 
# åŒ¹é…å…¨éƒ¨æ–‡ä»¶ 
[*] 
 
# è®¾ç½®å­—ç¬¦é›† 
charset = utf-8 
 
# ç¼©è¿›é£æ ¼ï¼Œå¯é€‰ spaceã€tab 
indent_style = tab 
 
# ç¼©è¿›çš„ç©ºæ ¼æ•°ï¼Œå½“ indent_style = tab å°†ä½¿ç”¨ tab_width 
# å¦åˆ™ä½¿ç”¨ indent_size 
indent_size = 2 
tab_width = 2 
 
# ç»“å°¾æ¢è¡Œç¬¦ï¼Œå¯é€‰ lfã€crã€crlf 
end_of_line = lf 
 
# åœ¨æ–‡ä»¶ç»“å°¾æ’å…¥æ–°è¡Œ 
insert_final_newline = true 
 
# åˆ é™¤ä¸€è¡Œä¸­çš„å‰åç©ºæ ¼ 
trim_trailing_whitespace = true 
 
# åŒ¹é…mdç»“å°¾çš„æ–‡ä»¶ 
[*.md] 
insert_final_newline = false 
trim_trailing_whitespace = false 
```

è™½ç„¶å®ƒæä¾›çš„æ ¼å¼åŒ–çš„é…ç½®å‚æ•°å¾ˆå°‘ï¼Œå°± 3 ä¸ªï¼Œç¼©è¿›é£æ ¼ã€æ˜¯å¦åœ¨æ–‡ä»¶æœ«å°¾æ’å…¥æ–°è¡Œå’Œæ˜¯å¦åˆ é™¤ä¸€è¡Œä¸­å‰åç©ºæ ¼ã€‚ä½†æ˜¯å®ƒè¿˜æ˜¯éå¸¸æœ‰å¿…è¦å­˜åœ¨çš„ï¼Œç†ç”±æœ‰ 3 ä¸ªï¼š

- èƒ½å¤Ÿåœ¨ä¸åŒçš„ç¼–è¾‘å™¨å’Œ IDE ä¸­ä¿æŒä¸€è‡´çš„ä»£ç é£æ ¼;
- é…åˆæ’ä»¶æ‰“å¼€æ–‡ä»¶å³è‡ªåŠ¨æ ¼å¼åŒ–ï¼Œéå¸¸æ–¹ä¾¿
- æ”¯æŒæ ¼å¼åŒ–çš„æ–‡ä»¶ç±»å‹å¾ˆå¤š;

å¦‚æœéœ€è¦è®©ä»¥ä¸Šçš„é…ç½®ç”Ÿæ•ˆï¼Œè¿˜å¾—åœ¨ VSCode é‡Œå®‰è£… EditorConfig for VS Code è¿™ä¸ªæ’ä»¶é…åˆä½¿ç”¨ã€‚

### é‡ç‚¹æ¥äº†

å¯ä»¥çœ‹åˆ° EditorConfig å’Œ Prettier ä¼šå­˜åœ¨ä¸€äº›é‡å¤çš„é…ç½®ï¼Œæ¯”å¦‚éƒ½æä¾›äº†å¯¹ç¼©è¿›çš„é…ç½®å‚æ•°ï¼Œæ‰€ä»¥åœ¨å®é™…ä½¿ç”¨çš„æ—¶å€™éœ€è¦é¿å…å®ƒä»¬ï¼Œæˆ–è€…æŠŠä»–ä»¬çš„å‚æ•°è®¾ç½®ä¸ºä¸€è‡´ã€‚



## åœ¨ VSCode ä¸­æ”¯æŒ ESLint

å‰é¢åšçš„é…ç½®ï¼Œéƒ½éœ€è¦æ‰§è¡Œå‘½ä»¤æ‰èƒ½è¿›è¡Œæ£€æŸ¥å’Œä¿®å¤ä»£ç ï¼Œè¿˜æ˜¯æŒºä¸æ–¹ä¾¿çš„ï¼Œå¦‚æœæˆ‘å¸Œæœ›ç¼–è¾‘å®Œæˆ–è€…ä¿å­˜çš„æ—¶å€™å»æ£€æŸ¥ä»£ç è¯¥å¦‚ä½•åšå‘¢?å¯ä»¥ç›´æ¥åœ¨ IDE é‡Œå®‰è£… ESLint æ’ä»¶ï¼Œå› ä¸ºæˆ‘ä½¿ç”¨çš„æ˜¯ VSCodeï¼Œæ‰€ä»¥è¿™é‡Œåªä»‹ç»åœ¨ VSCode ä¸­çš„é…ç½®ã€‚

- åœ¨ä½¿ç”¨å‰ï¼Œéœ€è¦æŠŠ ESLint æ‰©å±•å®‰è£…åˆ° VSCode é‡Œï¼Œè¿™é‡Œæˆ‘å°±ä¸ç»†è¯´å®‰è£…æ­¥éª¤äº†ã€‚å®‰è£…å®Œæˆåï¼Œéœ€è¦åœ¨è®¾ç½®é‡Œå†™å…¥é…ç½®ï¼š
- åœ¨ VSCode å·¦ä¸‹è§’æ‰¾åˆ°ä¸€ä¸ªé½¿è½® âš™ å›¾æ ‡ï¼Œç‚¹å‡»åé€‰æ‹©è®¾ç½®é€‰é¡¹ï¼Œè¿™ä¸ªæ—¶å€™æ‰“å¼€äº†è®¾ç½®é¢æ¿;
- ç„¶ååœ¨ VSCode å³ä¸Šè§’æ‰¾åˆ°æ‰“å¼€è®¾ç½®(json)çš„å›¾æ ‡ï¼Œç‚¹å‡»åï¼Œä¼šæ‰“å¼€ settings.json æ–‡ä»¶;

ç„¶åæŠŠä»¥ä¸‹é…ç½®è´´è¿›å»å³å¯;

```js
{ 
    "eslint.alwaysShowStatus": true,  // æ€»æ˜¯åœ¨ VSCode æ˜¾ç¤º ESLint çš„çŠ¶æ€ 
    "eslint.quiet": true,             // å¿½ç•¥ warning çš„é”™è¯¯ 
    "editor.codeActionsOnSave": {     // ä¿å­˜æ—¶ä½¿ç”¨ ESLint ä¿®å¤å¯ä¿®å¤é”™è¯¯ 
        "source.fixAll": true, 
        "source.fixAll.eslint": true 
    }  
} 
```

é…ç½®è¯´æ˜ï¼Œåœ¨ ESLint 2.0.4 ç‰ˆæœ¬å¼€å§‹ï¼š

- ä¸éœ€è¦é€šè¿‡ eslint.validate æ¥æŒ‡å®šæ ¡éªŒçš„æ–‡ä»¶ç±»å‹äº†ï¼Œå·²ç»è‡ªåŠ¨æ”¯æŒäº† .vue æ–‡ä»¶;
- editor.codeActionsOnSave å¼€å¯ä¿å­˜è‡ªåŠ¨ä¿®å¤åŠŸèƒ½;

å½“è¿™æ ·é…ç½®ä¹‹åå‘¢ï¼Œæ¯æ¬¡ç¼–è¾‘ä»£ç  ESLint éƒ½ä¼šå®æ—¶æ ¡éªŒä»£ç ï¼Œä¸”å½“ä¿å­˜çš„æ—¶å€™ä¼šè‡ªåŠ¨ fixï¼Œæ˜¯ä¸æ˜¯å¾ˆæ–¹ä¾¿å‘¢ã€‚ä¸è¿‡å¯¹äºæœ‰äº›æ— æ³•è‡ªåŠ¨ fix çš„ä»£ç å°±éœ€è¦ä½ æ‰‹åŠ¨å»ä¿®æ”¹äº†ï¼Œå¦‚æœä¸æƒ³ä¿®æ”¹çš„è¯å°±å¯ä»¥é…ç½® rules æŠŠè¯¥æ¡è§„åˆ™ç»™å…³é—­æ‰ã€‚

å…¶å®åœ¨å›¢é˜Ÿå¼€å‘çš„æ—¶å€™ï¼Œæœ€å¥½æŠŠé’ˆå¯¹ VSCode çš„é…ç½®ï¼Œå†™ä¸€ä¸ªæ–‡ä»¶è·Ÿéšç€é¡¹ç›®ï¼Œä¸€èµ·æäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œè¿™æ ·çš„è¯å°±ä¿è¯äº†é¡¹ç›®æˆå‘˜éƒ½æ˜¯ç”¨çš„è¿™å¥—é…ç½®ã€‚æ¯”å¦‚å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»º .vscode/settings.jsonï¼Œç„¶åå†™å…¥ä¸Šé¢çš„é‚£ä¸²é…ç½®å†…å®¹ã€‚



## åœ¨æäº¤å‰åšæ ¡éªŒ pre-commit

ä»¥ä¸Šåªæ˜¯é€šè¿‡ ESLint è‡ªåŠ¨ä¿®å¤èƒ½å¤Ÿä¿®å¤çš„é”™è¯¯ä»¥åŠé€šè¿‡ Prettier è¿›è¡Œä»£ç çš„æ ¼å¼åŒ–ï¼Œä½†æ˜¯åœ¨å®é™…å¼€å‘çš„æ—¶å€™éš¾å…ä¼šé‡åˆ°æ— æ³• fix çš„é”™è¯¯ï¼Œå¯èƒ½å¼€å‘äººå‘˜ä¹Ÿå¿˜è®°ä¿®æ”¹ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æŠŠä»£ç æäº¤åˆ°è¿œç¨‹ä»“åº“ï¼Œé‚£å°±æŠŠç³Ÿç³•çš„ä»£ç ç»™æäº¤ä¸Šå»äº†ã€‚

é‚£ä¹ˆå¦‚ä½•æœç»æŠŠç³Ÿç³•çš„ä»£ç æäº¤ä¸Šå»å‘¢?å¯ä»¥é€šè¿‡é…ç½® git hooks çš„ pre-commit é’©å­æ¥å®ç°è¿™ä¸ªç›®çš„ã€‚ä¸»è¦æ˜¯åˆ©ç”¨äº† husky[17] å’Œ lint-staged[18] è¿™ 2 ä¸ªåŒ…ã€‚husky å°±æ˜¯ç”¨æ¥é…ç½® git hooks çš„ï¼Œè€Œ lint-staged åˆ™æ˜¯å¯¹æ‹¿åˆ°çš„ staged æ–‡ä»¶è¿›è¡Œå¤„ç†ï¼Œæ¯”å¦‚æ‰§è¡Œ npx eslint --fix è¿›è¡Œä»£ç æ ¡éªŒã€‚

å…·ä½“æ“ä½œæ­¥éª¤å¦‚ä¸‹ï¼š

1ã€æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```js
npx mrm lint-staged 
```

ä¼šè‡ªåŠ¨å®‰è£… lint-staged å’Œ husky å¹¶ä¸”åœ¨ package.json é‡Œå†™å…¥ lint-stagedã€‚

â€œæ³¨æ„ï¼šmrm æ˜¯ä¸€ä¸ªè‡ªåŠ¨åŒ–å·¥å…·ï¼Œå®ƒå°†æ ¹æ® package.json ä¾èµ–é¡¹ä¸­çš„ä»£ç è´¨é‡å·¥å…·æ¥å®‰è£…å’Œé…ç½® husky å’Œ lint-stagedï¼Œå› æ­¤è¯·ç¡®ä¿åœ¨æ­¤ä¹‹å‰å®‰è£…å¹¶é…ç½®æ‰€æœ‰ä»£ç è´¨é‡å·¥å…·ï¼Œå¦‚ Prettier å’Œ ESlintã€‚

å¦‚æœä¸Šé¢é¡ºåˆ©ä¼šåœ¨ package.json é‡Œå†™å…¥ lint-stagedï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹è®©å®ƒæ”¯æŒ .vue æ–‡ä»¶çš„æ ¡éªŒï¼š

```js
{ 
    "lint-staged": { 
        "*.{js,vue}": "eslint --cache --fix" 
    } 
} 
```

2ã€å¯åŠ¨ git hooks

```js
npx husky install 
```

ç»è¿‡ä¸Šé¢çš„å‘½ä»¤åï¼Œv6 ç‰ˆæœ¬çš„ husky ä¼šåœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª .husky ç›®å½•ã€‚å¦‚æœæ˜¯ v4 ç‰ˆæœ¬çš„åˆ™ä¼šå†™å…¥åˆ° package.json é‡Œã€‚

3ã€åˆ›å»º pre-commit é’©å­

```js
npx husky add .husky/pre-commit "npx lint-staged" 
```

åˆ°è¿™é‡Œåï¼Œgit commit å‰è‡ªåŠ¨æ‰§è¡Œä»£ç æ ¡éªŒå’Œä¿®å¤çš„åŠŸèƒ½å°±ç®—å®Œæˆäº†ã€‚ç„¶åä½ å¯ä»¥è¯•è¯•ä¿®æ”¹æ–‡ä»¶ï¼Œç„¶åæäº¤è¯•è¯•ã€‚

[![img](https://cdn.jsdelivr.net/gh/JingWZeng/markdownImg/img/202110121439749.jpeg)](https://s6.51cto.com/oss/202106/18/ee85e3e0b534a49c4fa3809ed4ff7944.png?x-oss-process=image/format,jpg)



## æ€»ç»“

è¿™ç¯‡æ–‡ç« æ¯”è¾ƒé•¿ï¼Œå‰å‰ååè®²äº†å¾ˆå¤šä»£ç æ ¡éªŒçš„ä¸œè¥¿ï¼Œç°åœ¨æˆ‘ä»¬æ¥æ¢³ç†ä¸‹ã€‚

é¦–å…ˆç”¨ ESLint æ¥åšä»£ç æ ¡éªŒï¼Œå®ƒè‡ªå¸¦çš„ ruels èƒ½æä¾› 2 ç§ç±»å‹çš„æ ¡éªŒï¼Œåˆ†åˆ«æ˜¯ä»£ç é”™è¯¯æ ¡éªŒå’Œä»£ç æ ¼å¼æ ¡éªŒï¼Œè€Œ ESLint æœ¬èº«çš„æ ¸å¿ƒå·¥ä½œå…¶å®å°±æ˜¯æ ¡éªŒå’Œä¿®å¤é”™è¯¯çš„ä»£ç ï¼Œè€Œå¯¹æ ¼å¼åŒ–çš„è§„åˆ™æä¾›çš„ä¸å¤šã€‚

æ‰€ä»¥å¦‚æœæƒ³è¦å¯¹ä»£ç æ ¼å¼åŒ–è¿›è¡Œä¸€ä¸ªæ›´åŠ ç²¾ç»†çš„é…ç½®åˆ™éœ€è¦å€ŸåŠ© Prettierï¼Œå› ä¸ºå®ƒæ˜¯åªè´Ÿè´£é£æ ¼çš„ç®¡æ§ï¼Œæ‰€ä»¥ç”¨å®ƒå†é€‚åˆä¸è¿‡äº†ã€‚ä½†æ˜¯å¦‚æœæŠŠ ESLint å’Œ Prettier ç»“åˆèµ·æ¥ä¸€èµ·ä½¿ç”¨çš„è¯ï¼Œå°±å¯èƒ½ä¼šå‡ºç°è§„åˆ™çš„å†²çªäº†ï¼Œæ¯•ç«Ÿå®ƒä»¬ä¸¤è€…éƒ½ä¼šå¯¹é£æ ¼è¿›è¡Œå¤„ç†ï¼Œæ‰€ä»¥è¿™ä¸ªæ—¶å€™å°±å¯ä»¥é€šè¿‡ eslint-config-prettier è¿™ä¸ªæ‰©å±•æ¥æŠŠå†²çªçš„è§„åˆ™è¿›è¡Œå…³é—­ï¼Œè¿™ä¸ªæ‰©å±•ä¸ä»…å¯ä»¥å…³é—­å’Œ ESLint å†…ç½®è§„åˆ™çš„å†²çªï¼Œè¿˜å¯ä»¥å…³é—­å®é™…é¡¹ç›®ä¸­å¼•ç”¨åˆ°çš„æ‰©å±•è§„åˆ™çš„å†²çªï¼Œæ¯”å¦‚å’Œ Vueã€Reactã€TypeScriptã€Flow çš„å†²çªã€‚

åœ¨æŠŠ ESLint å’Œ Prettier ç»“åˆçš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸Œæœ›è®© ESLint æ¥æ£€æŸ¥ä»£ç é”™è¯¯ï¼Œè€Œ Prettier æ ¡éªŒä»£ç é£æ ¼ï¼Œé‚£ä¹ˆè¿™ä¸ªæ—¶å€™å…¶å®æ˜¯æœ‰ 2 ä¸ªä»»åŠ¡çš„ï¼Œéœ€è¦ç”¨ 2 æ¡å‘½ä»¤æ¥å¤„ç†çš„ã€‚ä½†æ˜¯æœ‰äº† eslint-plugin-prettier è¿™ä¸ªæ’ä»¶åå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŠŠå®ƒä»¬ç»“åˆèµ·æ¥ï¼Œå½“éœ€è¦æ ¡éªŒä»£ç é”™è¯¯çš„æ—¶å€™ ESLint è‡ªåŠ¨ä¼šç»™ä½ æ ¡éªŒï¼Œå½“ç„¶å‰ææ˜¯ VSCode é‡Œå¿…é¡»æŒ‰ç…§ ESLint æ’ä»¶ï¼Œè€Œå½“éœ€è¦æ ¡éªŒä»£ç é£æ ¼çš„æ—¶å€™ ESLint å°±ä¼šè°ƒç”¨ Prettier çš„èƒ½åŠ›è¿›è¡Œä»£ç é£æ ¼çš„æ£€æŸ¥ã€‚

æ–‡ç« çš„åé¢åˆ†åˆ«åˆç»†è¯´äº† EditorConfig å’Œæäº¤ä»£ç å‰æ ¡éªŒçš„å¤„ç†ï¼Œè¿™é‡Œå°±ä¸å¤šè®²äº†ã€‚

çœ‹åˆ°è¿™é‡Œå¸Œæœ›ä½ å¯¹ä»£ç æ ¡éªŒå’Œè§„èŒƒæœ‰ä¸€ä¸ªæ–°çš„è®¤è¯†ï¼Œä¸è¿‡æˆ‘æœ€å¸Œæœ›çš„æ˜¯ä½ èƒ½å¤Ÿè‡ªå·±åŠ¨æ‰‹ä¸ºä½ çš„é¡¹ç›®é…ç½®ä¸€å¥—æ ¡éªŒè§„åˆ™ã€‚

å‚è€ƒèµ„æ–™

[1] [Esprima](http://esprima.org/)

[2] [Espree](https://github.com/eslint/espree)

[3] [@babel/eslint-parser](https://github.com/babel/babel/tree/main/eslint/babel-eslint-parser)

[4] [@typescript-eslint/parser](https://github.com/typescript-eslint/typescript-eslint)

[5] [Specifying Environments](https://eslint.org/docs/user-guide/configuring/language-options#specifying-environments)

[6] [react .eslintrc.js](https://github.com/facebook/react/blob/master/.eslintrc.js)

[7] [eslint-config-standard](https://github.com/standard/eslint-config-standard)

[8] [eslint-config-prettier](https://github.com/prettier/eslint-config-prettier)

[9] [eslint-config-alloy](https://github.com/AlloyTeam/eslint-config-alloy)

[10] [ESLint plugins](https://eslint.org/docs/user-guide/configuring/plugins#configuring-plugins)

[11] [ESLinté…ç½®æ–‡ä»¶.eslintrcå‚æ•°è¯´æ˜](https://gist.github.com/rswanderer/29dc65efc421b3b5b0442f1bd3dcd046)

[12] [webpack .eslintrc.js](https://github.com/webpack/webpack/blob/master/.eslintrc.js)

[13] [eslint-plugin-vue](https://eslint.vuejs.org/user-guide/#faq)

[14] [prettier options](https://prettier.io/docs/en/options.html#print-width)

[15] [Trailing commas](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Trailing_commas#trailing_commas_in_functions)

[16] [EditorConfig](https://editorconfig.org/)

[17] [husky](https://typicode.github.io/husky/#/?id=install)

[18] [lint-staged](https://github.com/okonet/lint-staged)



